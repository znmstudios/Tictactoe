<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tic-Tac-Toe: Cyber Glow Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-dark: #0A192F;
            --x-color: #00FFFF; /* Electric Cyan */
            --o-color: #FF00FF; /* Neon Pink */
            --grid-line: #1F364D;
            --font-main: 'Orbitron', sans-serif;
        }

        body {
            background-color: var(--bg-dark);
            font-family: var(--font-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            color: white;
            padding: 20px;
        }

        /* Game Board Container */
        .board {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            width: 90vmin;
            max-width: 450px;
            height: 90vmin;
            max-height: 450px;
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.2);
            border-radius: 8px;
            overflow: hidden;
            transition: all 0.5s ease;
        }

        /* Individual Cell Styling */
        .cell {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 15vmin;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            border: 4px solid var(--grid-line);
            position: relative;
        }

        /* Remove inner borders to create the 3x3 effect */
        .cell:nth-child(3n) { border-right: none; }
        .cell:nth-child(3n + 1) { border-left: none; }
        .cell:nth-child(n):nth-child(-n+3) { border-top: none; }
        .cell:nth-child(n+7) { border-bottom: none; }

        /* Hover Effect */
        .cell:hover {
            background-color: rgba(255, 255, 255, 0.05);
        }

        /* Marker Styles (X and O) */
        .marker {
            opacity: 0;
            transform: scale(0.5);
            animation: pop-in 0.3s forwards cubic-bezier(0.68, -0.55, 0.27, 1.55);
            text-shadow: 0 0 10px;
            font-size: 100%;
            transition: color 0.3s;
        }

        .marker.X { color: var(--x-color); text-shadow: 0 0 20px var(--x-color); }
        .marker.O { color: var(--o-color); text-shadow: 0 0 20px var(--o-color); }

        @keyframes pop-in {
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* Win Line Effect */
        .win-line {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            z-index: 10;
            transition: all 0.5s ease-out;
            animation: flash-glow 1s infinite alternate;
        }

        @keyframes flash-glow {
            from { opacity: 0.8; }
            to { opacity: 1; }
        }

        /* Utility for Win Line */
        .win-row { height: 10px; width: 100%; }
        .win-col { width: 10px; height: 100%; }
        .win-diag-down { width: 120%; height: 10px; transform: rotate(45deg); }
        .win-diag-up { width: 120%; height: 10px; transform: rotate(-45deg); }

        /* Custom Button Style */
        .cyber-btn {
            background: linear-gradient(90deg, var(--x-color), var(--o-color));
            box-shadow: 0 0 15px var(--x-color);
            transition: all 0.3s ease-in-out;
            border: none;
            color: var(--bg-dark);
            font-weight: 700;
        }
        .cyber-btn:hover {
            box-shadow: 0 0 25px var(--o-color), 0 0 10px var(--x-color);
            transform: translateY(-2px);
        }
    </style>
</head>
<body>

    <h1 class="text-4xl md:text-5xl font-bold mb-8 tracking-widest text-white uppercase" style="text-shadow: 0 0 10px #888;">
        Tic-Tac-Toe
    </h1>

    <!-- Status Indicator -->
    <div id="status" class="text-2xl mb-6 py-2 px-6 rounded-full font-bold" style="background-color: rgba(255, 255, 255, 0.1); border: 2px solid var(--grid-line);">
        <span id="current-player-display">X's</span> Turn
    </div>

    <!-- Game Board -->
    <div id="board" class="board">
        <!-- Cells generated by JS -->
    </div>

    <!-- Reset Button -->
    <button id="reset-button" onclick="resetGame()" class="cyber-btn mt-8 py-3 px-8 rounded-lg text-lg">
        Reset Game
    </button>

    <!-- Modal for Winner/Draw -->
    <div id="modal" class="fixed inset-0 z-50 hidden items-center justify-center bg-gray-900 bg-opacity-80 transition-opacity duration-300">
        <div id="modal-content" class="p-10 rounded-xl text-center shadow-2xl transition transform duration-500 scale-90" style="background-color: var(--bg-dark); border: 3px solid var(--x-color);">
            <p id="modal-message" class="text-4xl font-black mb-6" style="color: var(--x-color);"></p>
            <button onclick="resetGame(); closeModal()" class="cyber-btn py-3 px-8 rounded-lg text-lg">
                Play Again
            </button>
        </div>
    </div>

    <script>
        // --- Game State ---
        let board = Array(9).fill(null);
        let currentPlayer = 'X';
        let isGameOver = false;

        // Winning combinations (indices of the board array)
        const WINNING_COMBOS = [
            // Rows
            [0, 1, 2, 'row', '0'], [3, 4, 5, 'row', '1'], [6, 7, 8, 'row', '2'],
            // Columns
            [0, 3, 6, 'col', '0'], [1, 4, 7, 'col', '1'], [2, 5, 8, 'col', '2'],
            // Diagonals
            [0, 4, 8, 'diag-down', 'center'], [2, 4, 6, 'diag-up', 'center']
        ];

        // --- DOM Elements ---
        const boardEl = document.getElementById('board');
        const statusEl = document.getElementById('status');
        const currentPlayerDisplayEl = document.getElementById('current-player-display');
        const modalEl = document.getElementById('modal');
        const modalMessageEl = document.getElementById('modal-message');
        const modalContentEl = document.getElementById('modal-content');
        
        // --- Core Functions ---

        /**
         * Renders the initial board structure and attaches event listeners.
         */
        function initializeBoard() {
            boardEl.innerHTML = '';
            for (let i = 0; i < 9; i++) {
                const cell = document.createElement('div');
                cell.classList.add('cell', 'group');
                cell.setAttribute('data-index', i);
                cell.addEventListener('click', () => handleMove(i));
                boardEl.appendChild(cell);
            }
            updateStatus();
        }

        /**
         * Updates the status message based on the current player.
         */
        function updateStatus() {
            currentPlayerDisplayEl.textContent = `${currentPlayer}'s`;
            // Color the turn indicator based on the current player
            currentPlayerDisplayEl.style.color = currentPlayer === 'X' ? 'var(--x-color)' : 'var(--o-color)';
            statusEl.style.borderColor = currentPlayer === 'X' ? 'var(--x-color)' : 'var(--o-color)';
        }

        /**
         * Handles a player's move on the selected cell.
         * @param {number} index - The index of the clicked cell.
         */
        function handleMove(index) {
            if (isGameOver || board[index] !== null) {
                return;
            }

            // 1. Update state
            board[index] = currentPlayer;
            
            // 2. Render the marker
            const cellEl = boardEl.querySelector(`[data-index="${index}"]`);
            const markerEl = document.createElement('span');
            markerEl.classList.add('marker', currentPlayer);
            markerEl.textContent = currentPlayer;
            cellEl.appendChild(markerEl);

            // 3. Check game status
            const winner = checkWinner();
            
            if (winner) {
                handleWin(winner);
            } else if (board.every(cell => cell !== null)) {
                handleDraw();
            } else {
                // 4. Switch player
                currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                updateStatus();
            }
        }

        /**
         * Checks the board state for a winner.
         * @returns {Array | null} The winning combination array or null.
         */
        function checkWinner() {
            for (const combo of WINNING_COMBOS) {
                const [a, b, c] = combo;
                if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                    return { winner: board[a], combo: combo };
                }
            }
            return null;
        }

        /**
         * Handles the win condition, displaying the winner and the win line.
         * @param {Object} winInfo - Contains the winner marker and the winning combination.
         */
        function handleWin(winInfo) {
            isGameOver = true;
            const { winner, combo } = winInfo;
            const [a, b, c, type, index] = combo;

            // 1. Highlight the winning cells
            const cells = [a, b, c].map(i => boardEl.querySelector(`[data-index="${i}"]`));
            
            // 2. Determine win line position/style
            const line = document.createElement('div');
            line.classList.add('win-line');
            line.style.backgroundColor = winner === 'X' ? 'var(--x-color)' : 'var(--o-color)';
            line.style.boxShadow = `0 0 20px ${winner === 'X' ? 'var(--x-color)' : 'var(--o-color)'}`;
            
            let centerPos = 0;
            if (type === 'row') centerPos = (cells[0].offsetTop + cells[0].offsetHeight / 2) - boardEl.offsetTop;
            if (type === 'col') centerPos = (cells[0].offsetLeft + cells[0].offsetWidth / 2) - boardEl.offsetLeft;
            
            // Apply line style
            line.classList.add(`win-${type}`);

            if (type === 'row') {
                line.style.top = `${centerPos}px`;
                line.style.left = '0%';
                line.style.transform = 'translateY(-50%)';
            } else if (type === 'col') {
                line.style.left = `${centerPos}px`;
                line.style.top = '0%';
                line.style.transform = 'translateX(-50%)';
            } else { // Diagonal
                line.style.width = '120%';
                line.style.height = '15px';
                line.style.left = '-10%';
                line.style.top = '50%';
                // Transform already set in CSS
            }
            
            boardEl.appendChild(line);
            
            // 3. Display Modal
            setTimeout(() => {
                showModal(`${winner} WINS!`, winner === 'X' ? 'var(--x-color)' : 'var(--o-color)');
            }, 500);
        }

        /**
         * Handles the draw condition.
         */
        function handleDraw() {
            isGameOver = true;
            showModal("It's a Draw!", 'white');
        }

        /**
         * Resets the game state and board display.
         */
        function resetGame() {
            board = Array(9).fill(null);
            currentPlayer = 'X';
            isGameOver = false;
            
            // Remove win line if present
            const winLine = boardEl.querySelector('.win-line');
            if (winLine) winLine.remove();

            initializeBoard(); // Re-render the fresh board
        }
        
        /**
         * Shows the winner/draw modal.
         * @param {string} message - The text message to display.
         * @param {string} color - The color for the message and modal border.
         */
        function showModal(message, color) {
            modalMessageEl.textContent = message;
            modalMessageEl.style.color = color;
            modalContentEl.style.borderColor = color;
            modalEl.classList.remove('hidden');
            modalEl.classList.add('flex');
            // Animate in
            setTimeout(() => {
                modalEl.style.opacity = '1';
                modalContentEl.style.transform = 'scale(1)';
            }, 50);
        }
        
        /**
         * Hides the winner/draw modal.
         */
        function closeModal() {
            modalEl.style.opacity = '0';
            modalContentEl.style.transform = 'scale(0.9)';
            // Hide completely after animation
            setTimeout(() => {
                modalEl.classList.remove('flex');
                modalEl.classList.add('hidden');
            }, 300);
        }

        // Initialize the game when the script loads
        initializeBoard();
    </script>
</body>
</html>
